{% extends 'base.html' %}
{% block content %}

<h2>
{% if table == 'guru' %}
    Kelola Data Guru
{% elif table == 'mapel' %}
    Kelola Data Mapel
{% elif table == 'kelas' %}
    Kelola Data Kelas
{% elif table == 'slot waktu' %}
    Kelola Data Slot waktu
{% else %}
    Kelola {{ table.replace("_", " ").title() }}
{% endif %}
</h2>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, msg in messages %}
      <div class="flash {{ category }}">{{ msg }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}

<hr>

<form method="POST">
  {% for col in cols %}
      {% if loop.index0 > 0 %} 
        <label>{{ col.replace("_", " ").title() }}</label>
        <input type="text" name="{{ col }}" required>
        <br>
      {% endif %}
  {% endfor %}
  <br>
  <button type="submit">âž• Tambah Data</button>
</form>

<hr>

<table border="1" cellpadding="6" width="100%">
  <thead>
    <tr>
      {% for c in cols %}
        <th>{{ c.replace("_", " ").title() }}</th>
      {% endfor %}
      <th>Aksi</th>
    </tr>
  </thead>

  <tbody>
    {% if data %}
      {% for row in data %}
        <tr>
          {% for c in cols %}
            <td>{{ row[c] }}</td>
          {% endfor %}
          <td>

            <form action="{{ url_for('delete_row', table=table, row_id=row[pk]) }}" method="post" onsubmit="return confirm('Yakin mau hapus data ini?')">
                <button type="submit">Hapus</button>
            </form>
          </td>
        </tr>
      {% endfor %}
    {% else %}
      <tr><td colspan="{{ cols|length + 1 }}" style="text-align:center;">Tidak ada data</td></tr>
    {% endif %}
  </tbody>
</table>

<style>
.flash { padding: 8px; margin: 8px 0; border-radius: 5px; }
.flash.success { background: #d4edda; color: #155724; }
.flash.danger { background: #f8d7da; color: #721c24; }
</style>

{% endblock %}
